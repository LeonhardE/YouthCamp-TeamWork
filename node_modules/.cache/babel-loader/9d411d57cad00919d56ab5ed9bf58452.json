{"ast":null,"code":"var _jsxFileName = \"/Users/jasmine/Desktop/me/\\u524D\\u7AEF/\\u5B57\\u8282\\u8DF3\\u52A8 \\u9752\\u8BAD\\u8425--\\u524D\\u7AEF/YouthCamp_TeamWork/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport RowItem from './component/RowItem.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst gainList = [];\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {\n      // 奖品内容\n      content: [],\n      // 奖品ID\n      itemId: [],\n      // 被选中的格子的ID\n      activedId: '',\n      // 中奖ID\n      prizeId: null,\n      // 获得prizeId之后计算出的动画次数\n      times: 0,\n      // 当前动画次数\n      actTimes: 0,\n      // 是否正在抽奖\n      isRolling: false,\n      // 金币\n      gold: 0,\n      // 中奖数组\n      gainList: []\n    };\n  }\n\n  componentDidMount() {\n    // 从后端获取奖品列表\n    fetch('http://localhost:5000/prizeinfo').then(res => res.json()).then(data => {\n      this.setState({\n        content: data.data.prize_content,\n        itemId: data.data.prize_id\n      });\n    });\n  }\n\n  handleBegin() {\n    // 判断是否在抽取过程中，以及金币是否足够\n    if (!this.state.isRolling && this.state.gold > 10) {\n      // 通过后台API获取奖品Id和转动次数\n      fetch('http://localhost:5000/roll').then(res => res.json()).then(data => {\n        console.log(\"data\");\n        console.log(data.data.id);\n        console.log(data.data.time); // 设置状态\n\n        this.setState({\n          activedId: 0,\n          actTimes: 0,\n          isRolling: true,\n          gold: this.state.gold - 10,\n          prizeId: data.data.id,\n          times: data.data.time\n        });\n      }); // 抽奖动画执行开始\n\n      this.begin = setInterval(() => {\n        if (this.state.activedId === this.state.prizeId && this.state.actTimes > this.state.times) {\n          // 符合上述所有条件时才是中奖的时候，两个ID相同并且动画执行的次数大于(或等于也行)设定的最小次数\n          clearInterval(this.begin);\n          this.setState({\n            isRolling: false\n          });\n          alert('恭喜获得 ' + this.state.content[this.state.prizeId] + '！请联系管理员兑换奖品');\n          gainList.push(this.state.content[this.state.prizeId]); // console.log(gainList);\n\n          return;\n        } // 以下是动画执行时对id的判断\n\n\n        if (this.state.activedId === 7) {\n          this.setState({\n            activedId: 0,\n            actTimes: this.state.actTimes + 1\n          });\n        } else {\n          this.setState({\n            activedId: this.state.activedId + 1,\n            actTimes: this.state.actTimes + 1\n          });\n        }\n      }, 80);\n    } else if (!this.state.isRolling && this.state.gold < 10) {\n      // 余额不足\n      alert('金币余额不足，请充值');\n    }\n  }\n\n  chargeGold() {\n    // 充值\n    this.setState({\n      gold: this.state.gold + 100\n    });\n  }\n\n  render() {\n    const {\n      content,\n      itemId,\n      activedId,\n      gold\n    } = this.state;\n    const newArr = [];\n    gainList.forEach((ele, index) => {\n      var temp = /*#__PURE__*/_jsxDEV(\"li\", {\n        children: ele\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 18\n      }, this);\n\n      newArr.push(temp);\n    });\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title\",\n        children: \"\\u5E78 \\u8FD0 \\u5927 \\u62BD \\u5956\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"left\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"intro\",\n          children: \"\\u6B22\\u8FCE\\u6765\\u5230\\u5E78\\u8FD0\\u5927\\u62BD\\u5956\\uFF01\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"intro\",\n          children: \"\\u4EE5\\u4E0B\\u4E3A\\u60A8\\u76EE\\u524D\\u6240\\u6301\\u7684\\u91D1\\u5E01\\u6570\\u91CF\\u3002\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"goldNum\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"goldNumText\",\n            children: [\"\\u91D1 \\u5E01: \", gold, \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"charge__btn\",\n          onClick: () => this.chargeGold(),\n          children: \"\\u5145 \\u503C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"centre\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"prize__container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container__area\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"begin__btn\",\n              onClick: () => this.handleBegin(),\n              children: \"\\u70B9\\u51FB\\u5F00\\u59CB\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"area__row\",\n              children: [/*#__PURE__*/_jsxDEV(RowItem, {\n                content: content[0],\n                itemId: itemId[0],\n                activedId: activedId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(RowItem, {\n                content: content[1],\n                itemId: itemId[1],\n                activedId: activedId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(RowItem, {\n                content: content[2],\n                itemId: itemId[2],\n                activedId: activedId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"area__row\",\n              children: [/*#__PURE__*/_jsxDEV(RowItem, {\n                content: content[7],\n                itemId: itemId[7],\n                activedId: activedId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(RowItem, {\n                content: content[3],\n                itemId: itemId[3],\n                activedId: activedId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"area__row\",\n              children: [/*#__PURE__*/_jsxDEV(RowItem, {\n                content: content[6],\n                itemId: itemId[6],\n                activedId: activedId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(RowItem, {\n                content: content[5],\n                itemId: itemId[5],\n                activedId: activedId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(RowItem, {\n                content: content[4],\n                itemId: itemId[4],\n                activedId: activedId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"right\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"lists\",\n          children: \"\\u60A8\\u7684\\u5956\\u54C1\\u5217\\u8868\\uFF1A \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"showLists\",\n          children: /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"listStyle\",\n            children: newArr\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/jasmine/Desktop/me/前端/字节跳动 青训营--前端/YouthCamp_TeamWork/src/App.js"],"names":["React","Component","RowItem","gainList","App","constructor","state","content","itemId","activedId","prizeId","times","actTimes","isRolling","gold","componentDidMount","fetch","then","res","json","data","setState","prize_content","prize_id","handleBegin","console","log","id","time","begin","setInterval","clearInterval","alert","push","chargeGold","render","newArr","forEach","ele","index","temp"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport RowItem from './component/RowItem.js'\n\nconst gainList = []\n\nclass App extends Component \n{\n  constructor() \n  {\n    super()\n    this.state = \n    {\n      // 奖品内容\n      content: [],\n      // 奖品ID\n      itemId: [],\n      // 被选中的格子的ID\n      activedId: '',\n      // 中奖ID\n      prizeId: null,\n      // 获得prizeId之后计算出的动画次数\n      times: 0,\n      // 当前动画次数\n      actTimes: 0,\n      // 是否正在抽奖\n      isRolling: false,\n      // 金币\n      gold: 0,\n      // 中奖数组\n      gainList: []\n    }\n  }\n\n  componentDidMount()\n  {\n    // 从后端获取奖品列表\n    fetch('http://localhost:5000/prizeinfo')\n    .then(res => res.json())\n    .then((data) => {\n      this.setState({\n        content: data.data.prize_content,\n        itemId: data.data.prize_id\n      })\n    })\n  }\n\n  handleBegin() \n  {\n    // 判断是否在抽取过程中，以及金币是否足够\n    if (!this.state.isRolling && this.state.gold > 10) \n    {\n      // 通过后台API获取奖品Id和转动次数\n      fetch('http://localhost:5000/roll')\n      .then(res => res.json())\n      .then((data) => {\n        console.log(\"data\")\n        console.log(data.data.id)\n        console.log(data.data.time)\n        // 设置状态\n        this.setState({\n          activedId: 0,\n          actTimes: 0,\n          isRolling: true,\n          gold: this.state.gold - 10,\n          prizeId: data.data.id,\n          times: data.data.time\n        })\n      })\n      // 抽奖动画执行开始\n      this.begin = setInterval(() => \n      {\n        if (this.state.activedId === this.state.prizeId && this.state.actTimes > this.state.times) \n        {\n          // 符合上述所有条件时才是中奖的时候，两个ID相同并且动画执行的次数大于(或等于也行)设定的最小次数\n          clearInterval(this.begin)\n          this.setState({\n            isRolling: false\n          })\n          alert('恭喜获得 '+ this.state.content[this.state.prizeId] +'！请联系管理员兑换奖品');\n          gainList.push(this.state.content[this.state.prizeId]);\n          // console.log(gainList);\n          return\n        }\n        // 以下是动画执行时对id的判断\n        if (this.state.activedId === 7) \n        {\n          this.setState({\n            activedId: 0,\n            actTimes: this.state.actTimes + 1\n          })\n        } \n        else \n        {\n          this.setState({\n            activedId: this.state.activedId + 1,\n            actTimes: this.state.actTimes + 1\n          })\n        }\n      }, 80)\n    }\n    else if (!this.state.isRolling && this.state.gold < 10)\n    {\n      // 余额不足\n      alert('金币余额不足，请充值')\n    }\n  }\n\n  chargeGold()\n  {\n    // 充值\n    this.setState({\n      gold: this.state.gold + 100\n    })\n  }\n\n  render() \n  {\n    const {content, itemId, activedId, gold} = this.state;\n    const newArr = [];\n    gainList.forEach((ele,index) => {\n      var temp = <li key={index}>{ele}</li>;\n      newArr.push(temp);\n    })\n    return (\n      <div className=\"App\">\n        <div className=\"title\">幸 运 大 抽 奖</div>\n        <div className=\"left\">\n          <p className=\"intro\">欢迎来到幸运大抽奖！</p>\n          <p className=\"intro\">以下为您目前所持的金币数量。</p>\n          <div className=\"goldNum\"> \n            <div className=\"goldNumText\">金 币: {gold} </div>\n          </div>\n          <button className=\"charge__btn\" onClick={() => this.chargeGold()}>充 值</button>\n        </div> \n        <div className=\"centre\">\n          <div className=\"prize__container\">\n            <div className=\"container__area\">\n              <div className=\"begin__btn\" onClick={() => this.handleBegin()}>\n                点击开始\n              </div>\n              <div className=\"area__row\">\n                <RowItem content={content[0]} itemId={itemId[0]} activedId={activedId} />\n                <RowItem content={content[1]} itemId={itemId[1]} activedId={activedId} />\n                <RowItem content={content[2]} itemId={itemId[2]} activedId={activedId} />\n              </div>\n              <div className=\"area__row\">\n                <RowItem content={content[7]} itemId={itemId[7]} activedId={activedId} />\n                <RowItem content={content[3]} itemId={itemId[3]} activedId={activedId} />\n              </div>\n              <div className=\"area__row\">\n                <RowItem content={content[6]} itemId={itemId[6]} activedId={activedId} />\n                <RowItem content={content[5]} itemId={itemId[5]} activedId={activedId} />\n                <RowItem content={content[4]} itemId={itemId[4]} activedId={activedId} />\n              </div>\n            </div>\n          </div>\n        </div> \n        <div className=\"right\">\n          <p className=\"lists\">您的奖品列表： </p>\n          <div className=\"showLists\">\n            <ul className=\"listStyle\">{newArr}</ul>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}